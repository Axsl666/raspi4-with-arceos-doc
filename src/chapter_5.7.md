# 实验三：xhci 控制器初始化，接管控制权

## USB 初始化

通过Uboot启动ArceOS时，我们已经发现飞腾派的USB接口已经可以识别出我们插入的USB存储设备，并能从存储设备中读取下载ArceOS启动镜像。这是由于在Uboot引导阶段，关于USB主机控制器已经被初始化成功，并且会加载相应的一些驱动程序：USB 控制器驱动程序、USB 存储设备驱动程序等。所以关于主机控制器的初始化工作，我们可以暂时跳过，直接用Uboot已经初始化的控制器，只需在ArceOS中接管其控制权便可以管理USB了。

## 接管控制权

1. 加载ArceOS：通过SD卡等引导设备实现

2. ArceOS初始化：内核开始初始化硬件和各种子系统。在初始化过程中，会尝试检测和配置已经初始化的 USB 控制器。

3. USB 子系统初始化：当操作系统识别到USB控制器后，USB子系统会被初始化。包括
   * 设备检测
   * 地址分配
   * 设备驱动程序加载
